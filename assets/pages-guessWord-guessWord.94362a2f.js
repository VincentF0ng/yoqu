import{j as t,o as e,a as s,w as a,e as n,f as o,t as i,b as c,d,i as l,g as u,v as r,k as h,E as p,G as m,H as f,S as g,q as b,C as y,D as w,n as C,X as _,y as v,r as k,a5 as S}from"./index-179abf92.js";import{_ as x}from"./uni-tag.25ae7898.js";import{_ as j,r as U}from"./uni-app.es.5e3c503e.js";import{_ as F}from"./uni-data-checkbox.75257a8a.js";import{_ as G}from"./r-canvas.4dcabee6.js";import{_ as T}from"./uni-popup.5f68b854.js";import"./uni-load-more.f043caa5.js";import"./uni-transition.eb92d77b.js";const I={en:{"uni-countdown.day":"day","uni-countdown.h":"h","uni-countdown.m":"m","uni-countdown.s":"s"},"zh-Hans":{"uni-countdown.day":"天","uni-countdown.h":"时","uni-countdown.m":"分","uni-countdown.s":"秒"},"zh-Hant":{"uni-countdown.day":"天","uni-countdown.h":"時","uni-countdown.m":"分","uni-countdown.s":"秒"}},{t:W}=t(I);const E=j({name:"UniCountdown",emits:["timeup"],props:{showHour:{type:Boolean,default:!0},showDay:{type:Boolean,default:!0},showColon:{type:Boolean,default:!0},startOnShow:{type:Boolean,default:!0},backgroundColor:{type:String,default:""},color:{type:String,default:"#333"},fontSize:{type:Number,default:14},splitorColor:{type:String,default:"#333"},day:{type:Number,default:0},hour:{type:Number,default:0},minute:{type:Number,default:0},second:{type:Number,default:0},timestamp:{type:Number,default:0}},data:()=>({timer:null,syncFlag:!1,d:"00",h:"00",i:"00",s:"00",leftTime:0,seconds:0}),computed:{dayText:()=>W("uni-countdown.day"),hourText:t=>W("uni-countdown.h"),minuteText:t=>W("uni-countdown.m"),secondText:t=>W("uni-countdown.s"),timeStyle(){const{color:t,backgroundColor:e,fontSize:s}=this;return{color:t,backgroundColor:e,fontSize:`${s}px`,width:22*s/14+"px",lineHeight:20*s/14+"px",borderRadius:3*s/14+"px"}},splitorStyle(){const{splitorColor:t,fontSize:e,backgroundColor:s}=this;return{color:t,fontSize:12*e/14+"px",margin:s?4*e/14+"px":""}}},watch:{day(t){this.changeFlag()},hour(t){this.changeFlag()},minute(t){this.changeFlag()},second(t){this.changeFlag()}},created:function(t){this.seconds=this.toSeconds(this.timestamp,this.day,this.hour,this.minute,this.second),this.countDown(),this.startOnShow&&this.startData()},unmounted(){clearInterval(this.timer)},methods:{toSeconds:(t,e,s,a,n)=>t?t-parseInt((new Date).getTime()/1e3,10):60*e*60*24+60*s*60+60*a+n,timeUp(){clearInterval(this.timer),this.$emit("timeup")},countDown(){let t=this.seconds,[e,s,a,n]=[0,0,0,0];t>0?(e=Math.floor(t/86400),s=Math.floor(t/3600)-24*e,a=Math.floor(t/60)-24*e*60-60*s,n=Math.floor(t)-24*e*60*60-60*s*60-60*a):this.timeUp(),e<10&&(e="0"+e),s<10&&(s="0"+s),a<10&&(a="0"+a),n<10&&(n="0"+n),this.d=e,this.h=s,this.i=a,this.s=n},startData(){if(this.seconds=this.toSeconds(this.timestamp,this.day,this.hour,this.minute,this.second),this.seconds<=0)return this.seconds=this.toSeconds(0,0,0,0,0),void this.countDown();clearInterval(this.timer),this.countDown(),this.timer=setInterval((()=>{this.seconds--,this.seconds<0?this.timeUp():this.countDown()}),1e3)},pause(){clearInterval(this.timer)},start(){clearInterval(this.timer),this.countDown(),this.timer=setInterval((()=>{this.seconds--,this.seconds<0?this.timeUp():this.countDown()}),1e3)},update(){this.startData()},changeFlag(){this.syncFlag||(this.seconds=this.toSeconds(this.timestamp,this.day,this.hour,this.minute,this.second),this.startData(),this.syncFlag=!0)}}},[["render",function(t,r,h,p,m,f){const g=l,b=u;return e(),s(b,{class:"uni-countdown"},{default:a((()=>[h.showDay?(e(),s(g,{key:0,style:n([f.timeStyle]),class:"uni-countdown__number"},{default:a((()=>[o(i(m.d),1)])),_:1},8,["style"])):c("",!0),h.showDay?(e(),s(g,{key:1,style:n([f.splitorStyle]),class:"uni-countdown__splitor"},{default:a((()=>[o(i(f.dayText),1)])),_:1},8,["style"])):c("",!0),h.showHour?(e(),s(g,{key:2,style:n([f.timeStyle]),class:"uni-countdown__number"},{default:a((()=>[o(i(m.h),1)])),_:1},8,["style"])):c("",!0),h.showHour?(e(),s(g,{key:3,style:n([f.splitorStyle]),class:"uni-countdown__splitor"},{default:a((()=>[o(i(h.showColon?":":f.hourText),1)])),_:1},8,["style"])):c("",!0),d(g,{style:n([f.timeStyle]),class:"uni-countdown__number"},{default:a((()=>[o(i(m.i),1)])),_:1},8,["style"]),d(g,{style:n([f.splitorStyle]),class:"uni-countdown__splitor"},{default:a((()=>[o(i(h.showColon?":":f.minuteText),1)])),_:1},8,["style"]),d(g,{style:n([f.timeStyle]),class:"uni-countdown__number"},{default:a((()=>[o(i(m.s),1)])),_:1},8,["style"]),h.showColon?c("",!0):(e(),s(g,{key:4,style:n([f.splitorStyle]),class:"uni-countdown__splitor"},{default:a((()=>[o(i(f.secondText),1)])),_:1},8,["style"]))])),_:1})}],["__scopeId","data-v-0b5fdb68"]]);const D=j({data:()=>({bannerAdpid:"",bannerUnitId:"",isGaming:!1,isGameover:!1,time:[4,0],timeRange:[],subjectAll:!1,subject:[],subjectList:[{subject:"电影",id:0},{subject:"歌名",id:1},{subject:"人物",id:2},{subject:"动物",id:3},{subject:"水果",id:4},{subject:"成语",id:5},{subject:"生活",id:6},{subject:"游戏",id:7}],words:["电影","歌名","达到","显示","顺丰的","儿儿顺丰","阿斯顿发"],isStop:!0,nowIndex:0,rightWords:[],touchStartX:0,touchEndX:0,resTempFilePath:""}),methods:{timeChange(t){r(),this.time=t.detail.value},subjectChange(t){r(),this.subjectAll=t.detail.value.length===this.subjectList.length},handleSubjectAll(t){r(),this.subjectAll=t,this.subject=t?this.subjectList.map((t=>t.id)):[]},gameInit(){r();const t=this.subject;if(!t.length)return h({title:"请选择主题",icon:"error"});p({title:"加载中"});m.importObject("guessWordOptions").getGuessWordItem(t).then((t=>{t.length?(this.words=t,this.isGaming=!0,this.isGameover=!1,this.isStop=!1,this.nowIndex=0,this.rightWords=[],this.resTempFilePath="",this.$refs.countdown.startData()):h({title:"获取词组失败！",icon:"error"})})).finally((t=>{f()}))},gameStart(){r(),this.isStop=!1,this.$refs.countdown.start()},gamePause(){r(),this.isStop=!0,this.$refs.countdown.pause()},gameGoback(){r(),g({title:"提示",content:"是否重新开始游戏？",success:t=>{t.confirm&&(this.isGaming=!1,this.isGameover=!1)}})},handleRight(){const t=this.words[this.nowIndex];-1===this.rightWords.indexOf(t)&&this.rightWords.push(t),this.nextWord()},handleWrong(){const t=this.words[this.nowIndex],e=this.rightWords.indexOf(t);-1===e||this.rightWords.splice(e,1),this.nextWord()},gameTouchstart(t){const e=t.touches[0]?t.touches[0].pageX:0;this.touchStartX=e,this.touchEndX=e},gameTouchmove(t){this.touchEndX=t.touches[0]?t.touches[0].pageX:0},gameTouchend(){const t=this.touchStartX,e=this.touchEndX;t<e-50?this.preWord():t>e+50&&this.nextWord()},preWord(){if(r(),0===this.nowIndex)return h({title:"到头了啦～",icon:"error"});this.nowIndex--},nextWord(){if(r(),this.nowIndex>=this.words.length-1)return g({title:"提示",content:"最后一个了，是否结束游戏？",success:t=>{t.confirm&&this.gameOver()}});this.nowIndex++},gameSetting(){this.$refs.popup.open("center")},settingPopupChange(t){t.show?this.gamePause():this.gameStart()},async gameOver(){this.isGaming=!1,this.isGameover=!0,p({title:"生成海报中..."});const t=("0"+this.rightWords.length).slice(-2);await this.$refs.rCanvas.clearCanvas(),await this.$refs.rCanvas.drawImage({url:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-9c9554a3-d4de-4f0f-b941-dfe1990da1c1/65d524d3-13cf-4f7b-8128-60b4fa3ac1b9.png",x:0,y:0,w:800,h:800}).catch((t=>{h({title:t,icon:"none"})})),await this.$refs.rCanvas.drawText({text:t,max_width:0,x:400,y:550,text_align:"center",font_color:"#f3b544",font_size:200}).catch((t=>{h({title:t,icon:"none"})})),await this.$refs.rCanvas.draw((t=>{this.resTempFilePath=t.tempFilePath})),f()},gameRestart(){r(),this.isGaming=!1,this.isGameover=!1},shareImage(){r(),uni.showShareImageMenu({path:this.resTempFilePath,success(t){h({title:"操作成功",icon:"success"})},fail(t){t.errMsg.includes("cancel")||(t.errMsg.includes("auth")?h({title:"请检查权限，右上角更多-设置-添加到相册。",icon:"none",duration:3e3}):h({title:"操作失败，可右上角反馈给开发者，谢谢",icon:"none",duration:3e3}))}})}},computed:{timeToString(){const t=this.time[0]+1,e=this.time[1];return`${("0"+t).slice(-2)}:${("0"+e).slice(-2)}`}},onReady(){p({title:"加载中"});m.importObject("guessWordOptions").getGuessWordSubject().then((t=>{t.length&&(this.subjectList=t)})).finally((t=>{f()}))},onLoad(){b().getConfig().then((t=>{this.bannerAdpid=t.bannerAdpid||"",this.bannerUnitId=t.bannerUnitId||""})),this.timeRange=[new Array(30).fill().map(((t,e)=>e+1)),new Array(60).fill().map(((t,e)=>e))],this.$refs.rCanvas.init({canvas_id:"rCanvas",canvas_width:800,canvas_height:800})},onShareAppMessage:()=>({title:"游趣街 - 你比划我猜，主题题库，自动记分。",path:"/pages/guessWord/guessWord",imageUrl:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-9c9554a3-d4de-4f0f-b941-dfe1990da1c1/7e0c654a-39d7-468e-bde0-c5c1a4b9962b.png"}),onShareTimeline:()=>({title:"游趣街 - 你比划我猜，主题题库，自动记分。",path:"/pages/guessWord/guessWord",imageUrl:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-9c9554a3-d4de-4f0f-b941-dfe1990da1c1/7e0c654a-39d7-468e-bde0-c5c1a4b9962b.png"})},[["render",function(t,c,l,r,h,p){const m=v,f=u,g=U(k("uni-tag"),x),b=U(k("uni-data-checkbox"),F),j=S,I=U(k("uni-countdown"),E),W=U(k("r-canvas"),G),D=U(k("uni-popup"),T);return e(),s(f,{class:"container"},{default:a((()=>[d(f,{class:C(["begin-form",{"screen-left":h.isGaming||h.isGameover}])},{default:a((()=>[d(m,{class:"begin-title",src:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-9c9554a3-d4de-4f0f-b941-dfe1990da1c1/8d434a2f-f34f-4fbb-8a30-170cd4323244.png",mode:"aspectFit"}),d(m,{class:"begin-bg",src:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-9c9554a3-d4de-4f0f-b941-dfe1990da1c1/38958bfb-d74b-4a0a-ad76-c1eddee2620d.png",mode:"aspectFit"}),d(f,{class:"item"},{default:a((()=>[d(f,{class:"label"},{default:a((()=>[o(" 主题 ")])),_:1}),d(f,{class:"input"},{default:a((()=>[y(d(g,{class:"tag-btn",text:"全选",type:"primary",onClick:c[0]||(c[0]=t=>p.handleSubjectAll(!0))},null,512),[[w,!h.subjectAll]]),y(d(g,{class:"tag-btn",text:"取消全选",type:"primary",onClick:c[1]||(c[1]=t=>p.handleSubjectAll(!1))},null,512),[[w,h.subjectAll]]),d(b,{selectedColor:"#50a045",mode:"tag",multiple:"",modelValue:h.subject,"onUpdate:modelValue":c[2]||(c[2]=t=>h.subject=t),localdata:h.subjectList,map:{text:"subject",value:"id"},onChange:p.subjectChange},null,8,["modelValue","localdata","onChange"])])),_:1})])),_:1}),d(f,{class:"item"},{default:a((()=>[d(f,{class:"label"},{default:a((()=>[o(" 时长 ")])),_:1}),d(f,{class:"input"},{default:a((()=>[d(j,{mode:"multiSelector",range:h.timeRange,value:h.time,onChange:p.timeChange},{default:a((()=>[d(g,{class:"tag-btn",text:p.timeToString,type:"primary"},null,8,["text"])])),_:1},8,["range","value","onChange"])])),_:1})])),_:1}),d(f,{class:"start-btn",onClick:p.gameInit},null,8,["onClick"])])),_:1},8,["class"]),d(f,{class:C(["game-wrap",{"screen-center":h.isGaming,"screen-left":h.isGameover}])},{default:a((()=>[d(f,{class:"game-options"},{default:a((()=>[y(d(m,{class:"options-btn",src:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-9c9554a3-d4de-4f0f-b941-dfe1990da1c1/c47d1141-ffa8-4cf8-98f6-938db351f7b4.png",mode:"aspectFit",onClick:p.gameStart},null,8,["onClick"]),[[w,h.isStop]]),y(d(m,{class:"options-btn",src:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-9c9554a3-d4de-4f0f-b941-dfe1990da1c1/b5c2e03a-6042-40e3-8d1c-60fe31973311.png",mode:"aspectFit",onClick:p.gamePause},null,8,["onClick"]),[[w,!h.isStop]]),d(m,{class:"options-btn",src:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-9c9554a3-d4de-4f0f-b941-dfe1990da1c1/b6305c20-4b2a-4168-b529-39eec74eb57e.png",mode:"aspectFit",onClick:p.gameGoback},null,8,["onClick"]),d(m,{class:"options-btn",src:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-9c9554a3-d4de-4f0f-b941-dfe1990da1c1/bedc4fb3-31f0-41e4-b899-f640ba6239bc.png",mode:"aspectFit",onClick:p.gameSetting},null,8,["onClick"])])),_:1}),d(f,{class:"game-center middle",onTouchstart:p.gameTouchstart,onTouchmove:p.gameTouchmove,onTouchend:p.gameTouchend},{default:a((()=>[d(m,{class:"game-bg",src:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-9c9554a3-d4de-4f0f-b941-dfe1990da1c1/40b82dea-69d6-4214-a568-65ce29a21581.png",mode:"aspectFit"}),d(f,{class:"score"},{default:a((()=>[d(m,{class:"score-bg",src:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-9c9554a3-d4de-4f0f-b941-dfe1990da1c1/fa32e0fb-dd88-460a-b75f-8679428777af.png",mode:"aspectFit"}),d(f,{class:"score-text"},{default:a((()=>[o(i(("0"+h.rightWords.length).slice(-2)),1)])),_:1})])),_:1}),d(f,{class:"countdown"},{default:a((()=>[d(I,{ref:"countdown","font-size":30,"start-on-show":!1,showDay:!1,showHour:!1,minute:h.time[0]+1,second:h.time[1],color:"#FFFFFF","splitor-color":"#FFFFFF","background-color":"#50a045",onTimeup:p.gameOver},null,8,["minute","second","onTimeup"])])),_:1}),d(f,{class:"word middle"},{default:a((()=>[o(i(h.words[h.nowIndex]),1)])),_:1}),d(f,{class:"action"},{default:a((()=>[d(m,{class:"action-btn",src:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-9c9554a3-d4de-4f0f-b941-dfe1990da1c1/4f000e8a-13de-49db-80f3-4808e1ef9905.png",mode:"aspectFit",onClick:_(p.handleWrong,["stop"])},null,8,["onClick"]),y(d(m,{class:"action-btn",src:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-9c9554a3-d4de-4f0f-b941-dfe1990da1c1/7de1a66b-2fdf-4f0d-9dc7-50058b14d0c4.png",mode:"aspectFit",onClick:_(p.handleRight,["stop"])},null,8,["onClick"]),[[w,-1==h.rightWords.indexOf(h.words[h.nowIndex])]])])),_:1})])),_:1},8,["onTouchstart","onTouchmove","onTouchend"]),d(f,{class:"msg"},{default:a((()=>[o("题板左右滑动可快速切换题目喔～")])),_:1})])),_:1},8,["class"]),d(f,{class:C(["game-over",{"screen-center":h.isGameover}]),style:n({"padding-top":h.bannerAdpid||h.bannerUnitId?"300rpx":"0"})},{default:a((()=>[d(m,{class:"begin-title",src:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-9c9554a3-d4de-4f0f-b941-dfe1990da1c1/8d434a2f-f34f-4fbb-8a30-170cd4323244.png",mode:"aspectFit"}),d(m,{class:"game-res",src:h.resTempFilePath,mode:"aspectFit"},null,8,["src"]),d(f,{class:"action-wrap"},{default:a((()=>[d(f,{class:"action-btn restart",onClick:p.gameRestart},null,8,["onClick"]),d(f,{class:"action-btn save",onClick:p.shareImage},null,8,["onClick"])])),_:1})])),_:1},8,["class","style"]),d(W,{ref:"rCanvas",style:{position:"absolute",top:"100%"}},null,512),d(D,{ref:"popup","background-color":"#fff",onChange:p.settingPopupChange},{default:a((()=>[d(f,{class:"game-popup"},{default:a((()=>[d(f,{class:"title"},{default:a((()=>[o("规则介绍")])),_:1}),d(f,{class:"content"},{default:a((()=>[o("答对：记一分，进入下一题；")])),_:1}),d(f,{class:"content"},{default:a((()=>[o("答错：不记分，进入下一题；")])),_:1}),d(f,{class:"content"},{default:a((()=>[o("操作：题板左右滑动可快速切换题目；")])),_:1})])),_:1})])),_:1},8,["onChange"])])),_:1})}],["__scopeId","data-v-103543a8"]]);export{D as default};
